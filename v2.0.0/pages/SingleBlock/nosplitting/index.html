<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Single Block with No Splitting · GridGeneration.jl</title><meta name="title" content="Single Block with No Splitting · GridGeneration.jl"/><meta property="og:title" content="Single Block with No Splitting · GridGeneration.jl"/><meta property="twitter:title" content="Single Block with No Splitting · GridGeneration.jl"/><meta name="description" content="Documentation for GridGeneration.jl."/><meta property="og:description" content="Documentation for GridGeneration.jl."/><meta property="twitter:description" content="Documentation for GridGeneration.jl."/><meta property="og:url" content="https://MarvynBailly.github.io/GridGeneration/stable/pages/SingleBlock/nosplitting/"/><meta property="twitter:url" content="https://MarvynBailly.github.io/GridGeneration/stable/pages/SingleBlock/nosplitting/"/><link rel="canonical" href="https://MarvynBailly.github.io/GridGeneration/stable/pages/SingleBlock/nosplitting/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">GridGeneration.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Ordinary Differential Equations</span><ul><li><a class="tocitem" href="../../ODE/ODEFormulation/">ODE Formulation</a></li><li><a class="tocitem" href="../../ODE/MathematicalWork/">Mathematical Work</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../Examples/airfoil/">Airfoil</a></li></ul></li><li><span class="tocitem">Numerical Methods</span><ul><li><a class="tocitem" href="../../NumericalMethods/FirstOrderSystem/">First Order System</a></li><li><a class="tocitem" href="../../NumericalMethods/SecondOrderBVP/">Second Order BVP ODE</a></li><li><a class="tocitem" href="../../NumericalMethods/SemiAnalyticalMethod/">Semi-Analytical Method</a></li></ul></li><li><span class="tocitem">2D to 1D Reformulation </span><ul><li><a class="tocitem" href="../../2Dto1D/Mapping2Dto1D/">Mapping 2D to 1D</a></li><li><a class="tocitem" href="../../2Dto1D/MetricReformulation/">Metric Reformulation</a></li><li><a class="tocitem" href="../../2Dto1D/PointProjection/">Projecting Points</a></li></ul></li><li><span class="tocitem">Grid Format</span><ul><li><a class="tocitem" href="../../GridFormat/">Grid Format</a></li></ul></li><li><span class="tocitem">Single Block Grid Input</span><ul><li class="is-active"><a class="tocitem" href>Single Block with No Splitting</a><ul class="internal"><li><a class="tocitem" href="#2D-Single-Block"><span>2D Single Block</span></a></li><li><a class="tocitem" href="#Algorithm"><span>Algorithm</span></a></li><li><a class="tocitem" href="#Custom-Metric"><span>Custom Metric</span></a></li></ul></li><li><a class="tocitem" href="../splitting/">Single Block with Splitting</a></li></ul></li><li><span class="tocitem">Multi-Block Grid Input</span><ul><li><a class="tocitem" href="../../MultiBlock/multiblock/">Multi-Block Input</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Single Block Grid Input</a></li><li class="is-active"><a href>Single Block with No Splitting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Single Block with No Splitting</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MarvynBailly/GridGeneration" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/MarvynBailly/GridGeneration/blob/main/docs/src/pages/SingleBlock/nosplitting.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Single-Block-with-No-Splitting"><a class="docs-heading-anchor" href="#Single-Block-with-No-Splitting">Single Block with No Splitting</a><a id="Single-Block-with-No-Splitting-1"></a><a class="docs-heading-anchor-permalink" href="#Single-Block-with-No-Splitting" title="Permalink"></a></h1><h2 id="2D-Single-Block"><a class="docs-heading-anchor" href="#2D-Single-Block">2D Single Block</a><a id="2D-Single-Block-1"></a><a class="docs-heading-anchor-permalink" href="#2D-Single-Block" title="Permalink"></a></h2><p>Let&#39;s start by allowing the user to input a single <a href="../../GridFormat/">Tortuga</a> block in the code. Thus the input will be the initial grid and the boundary information. The code will take in a 2D grid and solve the ODE along each edge of the domain. As the optimal number of points need not be the same for boundary edges across from each other, the code will proceed to resolve the edge that does not have the maximum number of points. Finally, the code will solve for the interior points using Transfinite Interpolation and update the boundary information with the new dimensions of the block. </p><h2 id="Algorithm"><a class="docs-heading-anchor" href="#Algorithm">Algorithm</a><a id="Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithm" title="Permalink"></a></h2><p>To solve a single block, we can pair up the left and top edges with the right and bottom edges respectively. For each pair, we do the following:</p><ul><li>for each pair:<ul><li>for each edge in pair<ul><li>Compute the 1D metric along the edge using <code>GridGeneration.Get1DMetric(pnts, metricFunction)</code></li><li>Project the edge to 1D using <code>GridGeneration.ProjectBoundary2Dto1D(edge)</code></li><li>Solve the ODE problem using the 1D metric and 1D points using <code>GridGeneration.SolveODE(m,m,N,xs)</code></li><li>Compute the optimal number of points using <code>GridGeneration.ComputeOptimalNumberofPoints(xs, m, sol)</code></li></ul></li><li>set optimal number of points for pair to the max of the edge optimal numbers</li><li>for each edge<ul><li>Solve the ODE problem using the pair optimal number of points using <code>GridGeneration.ComputeOptimalNumberofPoints(xs, m, sol)</code></li><li>Save edge distribution</li></ul></li></ul></li><li>Run TFI on edge distributions to get final grid using <code>GridGeneration.TFI_2D(boundary)</code></li></ul><p>Writing this in Julia:</p><pre><code class="language-julia hljs">function ProcessEdgePair(edgeA, edgeB, metricFunc, solver)
    metricA = GridGeneration.Get1DMetric(edgeA, metricFunc)
    metricB = GridGeneration.Get1DMetric(edgeB, metricFunc)

    xsA = GridGeneration.ProjectBoundary2Dto1D(edgeA)
    xsB = GridGeneration.ProjectBoundary2Dto1D(edgeB)

    solA = GridGeneration.SolveODE(metricA, metricA, length(xsA), xsA; method=solver)
    solB = GridGeneration.SolveODE(metricB, metricB, length(xsB), xsB; method=solver)

    optNA = GridGeneration.ComputeOptimalNumberofPoints(xsA, metricA, solA[1, :])
    optNB = GridGeneration.ComputeOptimalNumberofPoints(xsB, metricB, solB[1, :])

    optN = max(optNA, optNB)
    @info &quot;Optimal number of points: $optN&quot;

    solOptA = GridGeneration.SolveODE(metricA, metricA, optN, xsA; method=solver)
    solOptB = GridGeneration.SolveODE(metricB, metricB, optN, xsB; method=solver)

    projectedA = GridGeneration.ProjectBoundary1Dto2D(edgeA, solOptA[1, :], xsA)
    projectedB = GridGeneration.ProjectBoundary1Dto2D(edgeB, solOptB[1, :], xsB)

    return projectedA, projectedB
end

function SolveBlock(block, bndInfo, interInfo, metricFunc; solver=&quot;analytic&quot;)
    left   = block[:, 1, :]
    right  = block[:, end, :]
    projectedLeft, projectedRight = ProcessEdgePair(left, right, metricFunc, solver)

    bottom = block[:, :, 1]
    top    = block[:, :, end]
    projectedBottom, projectedTop = ProcessEdgePair(bottom, top, metricFunc, solver)

    computedBlock = GridGeneration.TFI_2D([projectedTop&#39;, projectedRight&#39;, projectedBottom&#39;, projectedLeft&#39;])

    bndInfo = GridGeneration.UpdateBndInfo!(bndInfo, computedBlock)

    return computedBlock, bndInfo, interInfo
end</code></pre><h2 id="Custom-Metric"><a class="docs-heading-anchor" href="#Custom-Metric">Custom Metric</a><a id="Custom-Metric-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Metric" title="Permalink"></a></h2><p>Let&#39;s also create a tool to output a custom metric field. I make this function by computing the distance from the airfoil to the point with the following <code>w_rational(d, A, ℓ, p) = A / (1 + (d/ℓ)^p)</code> where <span>$d$</span> is the distance, <span>$A$</span> controls the amplitude, and <span>$l$</span> and <span>$p$</span> are used to control the fall off. This gives the space around the airfoil a higher metric value which decreases as you move away from the boundary. Let&#39;s also add a &quot;hotspot&quot; to control where the function places more points. We can achieve this by using the same function from above but rather than using the distance from the airfoil, we pass in the distance to the <span>$(\text{hotspot}_x, \text{hotspot}_y)$</span>. Finally we can add these two functions togethers.</p><h3 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h3><p>Let&#39;s use a small grid around an airfoil as an example. Looping over hotspots along the airfoil domain we can make some fun gifs as shown below. We see that the basic TFI method struggles to preserve orthogonality in the interior points but I&#39;m not worried about this. We can use higher order TFI methods or elliptic smoothing to remedy this.</p><h4 id="Example-1"><a class="docs-heading-anchor" href="#Example-1">Example 1</a><a id="Example-1-1"></a><a class="docs-heading-anchor-permalink" href="#Example-1" title="Permalink"></a></h4><p><img src="../../../assets/gifs/SingleBlockns/hotspot_along_airfoil.gif" alt="test"/></p><h4 id="Example-2"><a class="docs-heading-anchor" href="#Example-2">Example 2</a><a id="Example-2-1"></a><a class="docs-heading-anchor-permalink" href="#Example-2" title="Permalink"></a></h4><p><img src="../../../assets/gifs/SingleBlockns/hotspot_along_airfoil_dense1.gif" alt="test"/></p><h4 id="Example-3"><a class="docs-heading-anchor" href="#Example-3">Example 3</a><a id="Example-3-1"></a><a class="docs-heading-anchor-permalink" href="#Example-3" title="Permalink"></a></h4><p><img src="../../../assets/gifs/SingleBlockns/hotspot_along_airfoil_dense2.gif" alt="test"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../GridFormat/">« Grid Format</a><a class="docs-footer-nextpage" href="../splitting/">Single Block with Splitting »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 23 September 2025 22:19">Tuesday 23 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
